#
# Generated by Chef for <%= node['fqdn'] %>
# Do NOT modify this file by hand, changes will be overwritten.
#

# <%= @name -%><% if @comment -%> - <%= @comment -%><% end -%>
subnet <%= @subnet %> netmask <%= @netmask%> {
  <% unless nil_or_empty?(@parameters) -%>
  # Parameters
  <% property_collection_sorted(@parameters).each do |parameter, value| -%>
  <%= parameter %><% unless nil_or_empty?(value) -%> <%= value %><% end -%>;
  <% end -%>
<% end -%>
<% unless nil_or_empty?(@options) -%>

  # Options
  <% property_collection_sorted(@options).each do |option, value| -%>
  option <%= option %> <%= value %>;
  <% end -%>
<% end -%>
<% unless nil_or_empty?(@extra_lines) -%>

  # Extra Lines
  <% @extra_lines.each do |line| -%>
  <%= line %>
  <% end -%>
<% end -%>
<% unless nil_or_empty?(@evals) -%>

  # Evals
  <% @evals.each do |eval| -%>
  <%= eval %>
  <% end -%>
<% end -%>
<% unless nil_or_empty?(@key) -%>

  # Key
  key <%= @key['name'] %> {
    algorithm <%= @key['algorithm'] %>;
    secret "<%= @key['secret'] %>";
  };
<% end -%>
<% unless nil_or_empty?(@zones) -%>

  # Zones
  <% @zones.each do |zone, options| -%>
  zone <%= zone %> {
    primary <%= options['primary'] %>;
    key <%= options['key'] %>;
  }
  <% end -%>
<% end -%>
<% unless nil_or_empty?(@pool) -%>
  
  # Pools
<% property_array(@pool).each do |pool| -%>
  pool {
    <% if pool['failover_peer'] -%>
    failover peer "<%= pool['failover_peer'] %>";
    <% end -%>
    <% unless nil_or_empty?(pool['options']) -%>

    # Options
    <% property_collection_sorted(pool['options']).each do |option| -%>
    option <%= option %>;
    <% end -%>
    <% end -%>
    <% unless nil_or_empty?(pool['parameters']) -%>

    # Parameters
    <% property_collection_sorted(pool['parameters']).each do |parameter, value| -%>
    <%= parameter %> <%= value %>;
    <% end -%>
    <% end -%>
    <% unless nil_or_empty?(pool['range']) %>
    
    # Ranges
    <% property_array(pool['range']).sort.each do |range| -%>
    range <%= range %>;
    <% end -%>
    <% end -%>
    <% unless nil_or_empty?(pool['deny']) -%>

    # Deny Access Control
    <% property_array(pool['deny']).sort.each do |denied| -%>
    deny <%= denied %>;
    <% end -%>
    <% end -%>
    <% unless nil_or_empty?(pool['allow']) -%> 

    # Allow Access Control
    <% property_array(pool['allow']).sort.each do |allowed| -%>
    allow <%= allowed %>;
    <% end -%>
    <% end -%>
  }
<% end -%>
<% end -%>
}
